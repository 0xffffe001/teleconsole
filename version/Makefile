BUILDDATE=`date +%F`
GITREF=`git describe --always --tags --dirty --long`

# $(VERSION_GO) will be written to version.go
VERSION_GO="/* DO NOT EDIT THIS FILE. IT IS GENERATED BY 'make setver'*/\n\
package version\n\
const( Version = \"$(VERSION)\"\nBuildDate= \"$(BUILDDATE)\"\n)\nvar Gitref string\n"

# $(GIT_GO) will be written to gitref.go
GITREF_GO="/* DO NOT EDIT THIS FILE. IT IS GENERATED BY make */ \n\n\
package version\n\
func init() { Gitref = \"$(GITREF)\"}  "

#
# setver updates version.go with VERSION
#
.PHONY:setver
setver:
	@printf $(VERSION_GO) | gofmt > version.go
	@printf $(GITREF_GO) | gofmt > git.go
